/* &copy; 2014 Lindsay Roberts http://www.designbyfish.com/ */
!function(a){function b(b){return a.getJSON(b)}function c(a){for(;/(\d+)(\d{3})/.test(a.toString());)a=a.toString().replace(/(\d+)(\d{3})/,"$1,$2");return a}function d(b,c){var d=[];return a.each(c,function(a,c){d.push({x:new Date(b[a]),y:c})}),d}var e=["../api/pro/annually/2014.json","../api/premium/annually/2014.json","../api/platinum/annually/2014.json"],f=[];a.each(e,function(a,c){f.push(b(c))}),a.when.apply(a,f).done(function(){for(var b=[],e=0,f=arguments.length;f>e;e++)b.push(arguments[e][0]);returns=[],pro_results={},premium_results={},platinum_results={},a.each(b,function(a,b){returns.push(b.statistics.total_return)});var g=Array.min(returns),h=Array.max(returns);a.each(b,function(a,b){b.statistics.total_return==h?platinum_results=b:b.statistics.total_return==g?pro_results=b:premium_results=b});var i=[],j=[],k=[],l=[];a.each(pro_results.logs,function(a,b){var c=b.date.year+"-"+(Number(b.date.month)<10?"0"+Number(b.date.month):Number(b.date.month))+"-"+(Number(b.date.day)<10?"0"+Number(b.date.day):Number(b.date.day))+"T00:00:00Z";i.push(c),j.push(Number(b.balance))}),a.each(premium_results.logs,function(a,b){k.push(Number(b.balance))}),a.each(platinum_results.logs,function(a,b){l.push(Number(b.balance))});var m=d(i,j),n=d(i,k),o=d(i,l),p={chartPadding:5,showArea:!1,lineSmooth:!1,fullWidth:!0,axisX:{labelInterpolationFnc:function(a){return a.getFullYear()}},axisY:{labelInterpolationFnc:function(a){var b=Math.pow(10,5);return Math.round(a*b)/b}}},q={series:[{name:"Pro Formula",data:m},{name:"Premium Formula",data:n},{name:"Platinum Formula",data:o}]},r=function(a){return{x:a.x,y:Math.log10(a.y)}},s=new Array("January","February","March","April","May","June","July","August","September","October","November","December");console.log(m,n,o);var t=new Chartist.DateAxis(Chartist.Axis.units.x,{ticksProvider:new Chartist.DateTicksProvider(Chartist.DateTicksProvider.Year)}),u=(new Chartist.LineXY("#chart",q,p,void 0,t,void 0,r),a(".ct-chart")),v=u.append('<div class="tooltip"></div>').find(".tooltip").hide();u.on("mouseenter",".ct-point",function(){var b=a(this),d=b.parent().attr("ct:series-name");"Pro Formula"==d?v.html('<span class="tooltip-seriesName">'+d+'</span><br><span class="tooltip-price">$'+c(Number(m[a(this).index()-1].y))+' USD</span><br><span class="tooltip-date">'+s[m[a(this).index()-1].x.getMonth()]+" "+m[a(this).index()-1].x.getFullYear()+"</span>").removeClass("tooltip-pro tooltip-premium tooltip-platinum").addClass("tooltip-pro").show():"Premium Formula"==d?v.html('<span class="tooltip-seriesName">'+d+'</span><br><span class="tooltip-price">$'+c(Number(n[a(this).index()-1].y))+' USD</span><br><span class="tooltip-date">'+s[n[a(this).index()-1].x.getMonth()]+" "+n[a(this).index()-1].x.getFullYear()+"</span>").removeClass("tooltip-pro tooltip-premium tooltip-platinum").addClass("tooltip-premium").show():"Platinum Formula"==d&&v.html('<span class="tooltip-seriesName">'+d+'</span><br><span class="tooltip-price">$'+c(Number(o[a(this).index()-1].y))+' USD</span><br><span class="tooltip-date">'+s[o[a(this).index()-1].x.getMonth()]+" "+o[a(this).index()-1].x.getFullYear()+"</span>").removeClass("tooltip-pro tooltip-premium tooltip-platinum").addClass("tooltip-platinum").show()}),u.on("mouseleave",".ct-point",function(){v.hide()}),u.on("mousemove",function(a){v.css({left:(a.offsetX||a.originalEvent.layerX)-v.width()/2-10,top:(a.offsetY||a.originalEvent.layerY)-v.height()-40})})}),Array.min=function(a){return Math.min.apply(Math,a)},Array.max=function(a){return Math.max.apply(Math,a)}}(jQuery);