/* &copy; 2015 Lindsay Roberts http://www.designbyfish.com/ */
!function(a){function b(b){function g(){if(h<b.length){var k=f(b[h].ticker),l=e(new Date),m=e(new Date((new Date).getTime()-2592e6)),n="6SfHcXos6YBX51kuAq8B",o="https://www.quandl.com/api/v1/datasets/WIKI/"+k+".json?trim_start="+m+"&trim_end="+l+"&auth_token="+n;k.indexOf("_TO")>-1&&(o="https://www.quandl.com/api/v1/datasets/YAHOO/TSX_"+k+".json?trim_start="+m+"&trim_end="+l+"&auth_token="+n),a.ajax({url:o,success:function(a){i.push(a),h++,g()},error:function(){o="https://www.quandl.com/api/v1/datasets/GOOG/NASDAQ_"+k+".json?trim_start="+m+"&trim_end="+l+"&auth_token="+n,a.ajax({url:o,success:function(a){i.push(a),h++,g()},error:function(){o="https://www.quandl.com/api/v1/datasets/GOOG/NYSE_"+k+".json?trim_start="+m+"&trim_end="+l+"&auth_token="+n,a.ajax({url:o,success:function(a){i.push(a),h++,g()},error:function(){o="https://www.quandl.com/api/v1/datasets/GOOG/AMEX_"+k+".json?trim_start="+m+"&trim_end="+l+"&auth_token="+n,a.ajax({url:o,success:function(a){i.push(a),h++,g()},error:function(){i.push({error:"Could not retrieve data for "+k}),h++,g()}})}})}})}})}else{for(var p=0;p<i.length;p++)if(i[p].error){console.log("There was an error for line-chart-"+p);var q="#line-chart-"+p;a(q).parent().addClass("line-chart-error");var r="Data could not be retrieved for "+b[p].ticker;a(q).html('<p class="chart-error"><i class="fa fa-exclamation-triangle fa-lg"></i><br />'+r+"</p>")}else{var s=d(i[p],b[p].suggested_price),s=s.reverse(),t=c(s,b[p].suggested_price),u="line-chart-"+p;j.push(AmCharts.makeChart(u,t)),console.log("Data was retrieved for line-chart-"+p)}console.log(j)}}var h=0;g()}function c(a,b){return{type:"serial",theme:"light",marginTop:9,marginRight:17,marginLeft:16,marginBottom:25,autoMargins:!1,pathToImages:"/js/amcharts/images/",dataProvider:a,valueAxes:[{inside:!0,axisAlpha:0}],graphs:[{balloonText:"<div style='magin:5px; font-size:18px;'><span style='font-size:13px;'>[[price]]</span></div>",bullet:"round",bulletBorderAlpha:1,bulletBorderColor:"#FFFFFF",hideBulletsCount:50,lineThickness:2,lineColor:"#D9124A",negativeLineColor:"#12D99E",valueField:"value",negativeBase:b}],chartScrollbar:{},chartCursor:{},categoryField:"date",categoryAxis:{parseDates:!0,axisAlpha:0,minHorizontalGap:55}}}function d(a){var b=[];return a.data.forEach(function(a){b.push({date:new Date(a[0]),price:g(a[4]),value:a[4]})}),b}function e(a){var b=new Date(a),c=""+(b.getMonth()+1),d=""+b.getDate(),e=b.getFullYear();return c.length<2&&(c="0"+c),d.length<2&&(d="0"+d),[e,c,d].join("-")}function f(a){var b=a.split(".").join("_");return b}function g(a){for(;/(\d+)(\d{3})/.test(a.toString());)a=a.toString().replace(/(\d+)(\d{3})/,"$1,$2");return"$"+a}var h={actionable:[{date:{day:"17",month:"4",year:"2015"},name:"CARBO CERAMICS      ",ticker:"CRR",action:"BUY",suggested_price:31.19,percentage_weight:99.9983,advanced_data:[{name:"cyclically_adjusted_earnings_yield",display_name:"Cyclically Adjusted Earnings Yield",value:9.87048,unit:"percent",description:"The cyclically adjusted price-to-earnings ratio is a valuation measure usually applied to the US S&P 500 equity market."},{name:"dividend_yield",display_name:"Divident Yield",value:4.03976,unit:"percent",description:"The dividend yield of a share is the dividend per share, divided by the price per share."}]},{date:{day:"17",month:"4",year:"2015"},name:"CARBO CERAMICS      ",ticker:"NUS",action:"BUY",suggested_price:60.11,percentage_weight:35.9983,advanced_data:[{name:"cyclically_adjusted_earnings_yield",display_name:"Cyclically Adjusted Earnings Yield",value:9.87048,unit:"percent",description:"The cyclically adjusted price-to-earnings ratio is a valuation measure usually applied to the US S&P 500 equity market."},{name:"dividend_yield",display_name:"Divident Yield",value:4.03976,unit:"percent",description:"The dividend yield of a share is the dividend per share, divided by the price per share."}]}]},i=[],j=[];b(h.actionable)}(jQuery);